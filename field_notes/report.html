<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Report | Jason Allred</title>
    <link rel="stylesheet" href="style.css?v=10.3">
    <style>
        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: #111;
            border: 1px solid #333;
            padding: 20px;
            border-left: 4px solid var(--accent-color);
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
        }
        .stat-label {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
        }
        .win-list {
            list-style: none;
            padding: 0;
        }
        .win-item {
            border-bottom: 1px solid #222;
            padding: 15px 0;
        }
        .win-date { color: var(--accent-color); font-size: 0.8rem; font-weight: bold; }
        .win-summary { color: #fff; margin: 5px 0; font-weight: bold; }
        .win-evidence { color: #aaa; font-size: 0.9rem; }
    </style>
</head>
<body>
    <button id="menu-toggle">â˜° MENU</button>

    <nav id="sidebar">
        <h1>The Field Manual</h1>
        <div class="subtitle">Jason Allred</div>
        <section id="mission-control">
            <h2>Mission Control</h2>
            <ul>
                <li><a href="stories.html" class="mission-link">Stories</a></li>
                <li><a href="timeline.html" class="mission-link">Notes: Logs</a></li>
                <li><a href="files.html" class="mission-link">Artifacts: Files</a></li>
                <li><a href="pager.html" class="mission-link">Pager: Alerting</a></li>
                <li><a href="intercom/" class="mission-link">Intercom</a></li>
                <li><a href="report.html" class="mission-link">Mission Report</a></li>
                <li><a href="https://monitor.jason-lab.dev" target="_blank" class="mission-link">Graphana: Observability</a></li>
                <li><a href="https://code.jason-lab.dev" target="_blank" class="mission-link">VS Code (Remote)</a></li>
            </ul>
        </section>
    </nav>

    <main>
        <h2 class="section-title">Mission Synthesis Report</h2>
        
        <div class="report-grid">
            <div class="stat-card">
                <div class="stat-value" id="stat-total-events">---</div>
                <div class="stat-label">Processed Events</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-brain-ratio">---</div>
                <div class="stat-label">Brain Contribution</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-last-scan">---</div>
                <div class="stat-label">Latest Discovery</div>
            </div>
        </div>

        <section>
            <h3>High-Fidelity Technical Wins</h3>
            <div id="top-wins" class="win-list">
                <!-- Populated via JS -->
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Fetch Status
            fetch('data/status.json?t=' + new Date().getTime())
                .then(r => r.json())
                .then(status => {
                    document.getElementById('stat-total-events').textContent = status.total_events || "0";
                    document.getElementById('stat-last-scan').textContent = status.timestamp || "---";
                    document.getElementById('stat-brain-ratio').textContent = status.engine === "Curriculum/TTCS" ? "High (Hybrid)" : "Standard";
                });

            // Fetch Top Wins (Latest month)
            fetch('data/2024.json')
                .then(r => r.json())
                .then(data => {
                    const container = document.getElementById('top-wins');
                    // Take last 5
                    data.slice(-5).reverse().forEach(win => {
                        const div = document.createElement('div');
                        div.className = 'win-item';
                        div.innerHTML = `
                            <div class="win-date">${win.date}</div>
                            <div class="win-summary">${win.summary}</div>
                            <div class="win-evidence">${win.evidence}</div>
                        `;
                        container.appendChild(div);
                    });
                });
        });
    </script>
</body>
</html>
